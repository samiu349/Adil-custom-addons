<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data noupdate="1">

    <record id="email_notification_paynow" model="mail.template">
        <field name="name">Notification Création BC</field>
        <field name="model_id" eval="model('ir.model').search([('model', '=', 'purchase.order')], limit=1).id"/>
        <field name="subject">[Nouvelle Commande] ${object.name or 'BC'}</field>
        <field name="email_from">${(user.email or '')|safe}</field>
        <field name="email_to">${', '.join([user.email for user in object.env.ref('alt_larmouss_custom.group_purchase_approver').users if user.email])}</field>
        <field name="body_html" type="html">
            <![CDATA[
                <p>Bonjour,</p>
                <p>Une nouvelle commande fournisseur a été créée :</p>
                <ul>
                    <li><strong>Référence :</strong> ${object.name}</li>
                    <li><strong>Fournisseur :</strong> ${object.partner_id.name}</li>
                    <li><strong>Date :</strong> ${object.date_order}</li>
                    <li><strong>Total :</strong> ${format_amount(object.amount_total, object.currency_id)}</li>
                </ul>
                <p><a href="${object.get_portal_url()}">Voir la commande</a></p>
            ]]>
        </field>
        <field name="auto_delete" eval="True"/>
    </record>

  </data>
</odoo>
